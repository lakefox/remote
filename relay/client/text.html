<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>File Navigator</title>
        <style>
            ul {
                list-style: none;
            }

            .folder {
                margin-left: 20px;
            }

            .file {
                margin-left: 40px;
            }

            .expander::before {
                content: "▸";
                margin-right: 5px;
            }

            .expander.expanded::before {
                content: "▾";
            }
        </style>
    </head>
    <body>
        <ul id="fileNavigator"></ul>
        <script>
            // ...

            function createFileNavigator(parent, data) {
                const ul = document.createElement("ul");
                parent.appendChild(ul);

                data.forEach((item) => {
                    const li = document.createElement("li");
                    ul.appendChild(li);

                    if (
                        typeof item === "object" &&
                        item.contents &&
                        item.contents.length > 0
                    ) {
                        const expander = document.createElement("span");
                        expander.className = "expander";
                        li.appendChild(expander);
                        li.appendChild(
                            document.createTextNode(getFolderName(item.path))
                        );
                        expander.addEventListener("click", () => {
                            li.classList.toggle("expanded");
                        });

                        createFileNavigator(li, item.contents);
                    } else {
                        li.className = "file";
                        li.textContent = item;
                    }
                });
            }

            function getFolderName(path) {
                // Extract the last part of the path as the folder name
                const parts = path.split("/");
                return parts[parts.length - 1];
            }

            function convertToNestedStructure(data) {
                const result = [];

                // Create a map to track folders by path
                const foldersMap = new Map();

                data.forEach((item) => {
                    const pathParts = item.path
                        .split("/")
                        .filter((part) => part !== "");
                    let currentFolder = result;

                    pathParts.forEach((part, index) => {
                        if (!foldersMap.has(part)) {
                            const folder = {
                                path: `/${pathParts
                                    .slice(0, index + 1)
                                    .join("/")}`,
                                contents: [],
                            };
                            foldersMap.set(part, folder);
                            currentFolder.push(folder);
                        }
                        currentFolder = foldersMap.get(part).contents;
                    });

                    if (
                        typeof item.contents === "object" &&
                        item.contents.length > 0
                    ) {
                        currentFolder.push(...item.contents);
                    } else {
                        currentFolder.push(item.contents);
                    }
                });

                return result;
            }

            const fileNavigator = document.getElementById("fileNavigator");
            createFileNavigator(fileNavigator, directoryStructure);
        </script>
    </body>
</html>
